<div class="page">
  <!-- HEADER -->
  <div style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 20px 60px;
          font-size: 18px;
          color: #1e3a8a;
        ">
    <span>üåê www.costsegregationguys.com</span>
    <span>Page 03</span>
  </div>

  <!-- TITLE -->
  <div style="padding: 10px 60px 0">
    <h2 style="
            font-size: 36px;
            color: #0f2e5a;
            margin: 0 0 18px 0;
            line-height: 1.25;
          ">
      Example Depreciation Breakdown<br />
      <span style="font-weight: 500">(with Cost Segregation Study):</span>
    </h2>
  </div>

  <!-- MAIN GRID -->
  <div style="
          display: grid;
          grid-template-columns: 1.05fr 1fr;
          gap: 40px;
          padding: 0 60px;
          align-items: start;
        ">
    <!-- LEFT: LEGEND + TEXT -->
    <div>
      <!-- LEGEND -->
      <div style="font-size: 20px; margin-bottom: 22px">
        <% proposalData.page3.content.legend.forEach(item=> { %>
        <div style="margin-bottom: 4px;">
          <%= item %>
        </div>
        <% }) %>
      </div>
    </div>

    <!-- RIGHT: CHART -->
    <div style="
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 3px;
          ">
      <canvas id="page3Chart" width="300" height="300"></canvas>
    </div>
  </div>

  <!-- TEXT BELOW CHART -->
  <div style="padding: 10px 60px 40px; color: #000;">
    <p style="font-size: 24px; margin-bottom: 14px; line-height: 1.4;">
      <%= proposalData.page3.content.intro %>
    </p>
    <ul style="font-size: 18px; list-style-position: outside; padding-left: 20px; margin-bottom: 20px; line-height: 1.4;">
      <% proposalData.page3.content.costList.forEach(item=> { %>
      <li style="margin-bottom: 4px;">
        <%= item %>
      </li>
      <% }) %>
    </ul>

    <p style="font-size: 24px; margin-bottom: 14px; line-height: 1.4;">
      <%= proposalData.page3.content.analysisPara1 %>
    </p>

    <p style="font-size: 24px; margin-bottom: 20px; line-height: 1.4;">
      <%= proposalData.page3.content.analysisPara2 %>
    </p>

    <div style="font-size: 16px; line-height: 1.5;">
      <% proposalData.page3.content.breakdownList.forEach((item, index)=> { %>
      <div style="margin-bottom: 2px;">
        <%= item %>
      </div>
      <% }) %>
    </div>

    <div style="font-size: 24px; font-weight: bold; margin-top: 25px; color: #1e3a8a;">
      <%= proposalData.page3.content.total %>
    </div>
  </div>

  <!-- ANGLED SHAPES -->
  <div style="
            position: absolute;
            width: 80px;
            height: 280px;
            background: #0f2e5a;
            transform: rotate(45deg);
            right: -70px;
            bottom: 100px;
            z-index: -1;
        "></div>
  <div style="
            position: absolute;
            width: 80px;
            height: 280px;
            background: #1e4ed8;
            transform: rotate(45deg);
            right: -80px;
            bottom: 40px;
            z-index: -2;
        "></div>

  <!-- ANGLED SHAPES -->
  <div style="
            position: absolute;
            width: 80px;
            height: 280px;
            background: #0f2e5a;
            transform: rotate(45deg);
            right: -70px;
            bottom: 100px;
            z-index: -1;
        "></div>
  <div style="
            position: absolute;
            width: 80px;
            height: 280px;
            background: #1e4ed8;
            transform: rotate(45deg);
            right: -80px;
            bottom: 40px;
            z-index: -2;
        "></div>
</div>

<script>
  // Register the plugin
  Chart.register(ChartDataLabels);

  const chartData = <%- JSON.stringify(proposalData.page3.content.chart) %>;

  new Chart(document.getElementById("page3Chart"), {
    type: "pie",
    data: {
      labels: chartData.labels,
      datasets: [{
        data: chartData.values,
        backgroundColor: chartData.colors,
      }, ],
    },
    options: {
      responsive: false,
      plugins: {
        legend: {
          display: false
        },
        datalabels: {
          color: '#fff',
          font: {
            weight: 'bold',
            size: 11
          },
          formatter: (value, ctx) => {
            return '$' + value.toLocaleString();
          },
          align: 'center',
          anchor: 'center'
        }
      },
    },
  });
</script>